---
title: "Report: Dissimilarities Heatmap (Fig. 3D)"
author: "Aurea Simon-Soro"
date: \today
output:
  pdf_document: default
  html_document: default
---



Run after running the first .Rmd file "Change.Body-Sites.Kyle.1.Rmd"
This figure is following the methods of:https://www.pnas.org/content/115/25/E5786#sec-10 (figure 3)


# Beta diversity. Bray_curtis for TB and PBS groups

```{r Intervals Caries}
#Create a column defining the interval of 
##Caries.E
s_tb$CariesE.Interval <-cut(s_tb$Caries.E, breaks=c(0,9,24,49,99), labels = c("E.<10", "E.10-25", "E.26-50", "E.>50")) 

##Caries.Ds
s_tb$CariesDs.Interval <-cut(s_tb$Caries.Ds, breaks=c(0,9,24,49,99), labels = c("Ds.<10", "Ds.10-25", "Ds.26-50", "Ds.>50")) 


##Caries.Dm
s_tb$CariesDm.Interval <-cut(s_tb$Caries.Dm, breaks=c(0,9,24,49,99), labels = c("Dm.<10", "Dm.10-25", "Dm.26-50", "Dm.>50"))

##Caries.Dx
s_tb$CariesDx.Interval <-cut(s_tb$Caries.Dx, breaks=c(0,9,24,49,99), labels = c("Dx.<10", "Dx.10-25", "Dx.26-50",  "Dx.>50")) 

```

```{r Intervals Weight}
#Create a column defining the interval of 
##Weight
s_tb$Weight.Interval <-cut(s_tb$Weight, breaks=c(0,79,89,100), labels = c("weight.<80", "weight.80-90", "weight.>90")) %>% as.factor()
```

```{r Intervals CFU}
#Create a column defining the interval of 
##Candida albicans CFU jaw
s_tb$C.albicans_CFU.jaw.Interval <-cut(s_tb$C.albicans_CFU.jaw, breaks=c(0,99,999,9999,99999), labels = c("Ca.<1e2", "Ca.1e2-1e3", "Ca.1e3-1e4", "Ca.>1e4"))
##S.mutans CFU jaw
s_tb$S.mutans_CFU.jaw.Interval <-cut(s_tb$S.mutans_CFU.jaw, breaks=c(0,99999,999999, Inf), labels = c("Sm.<1e5", "Sm.1e5-1e6", "Sm.>1e6"))


```

##Feces
```{r Subset of Feces}

#Subset of each sampletype also including the distance matrix subset calculation for each one
##Oral Swab
Feces.df <- filter(s_tb, SampleType=="Feces") #Dataframe 
dist_in.feces <- usedist::dist_subset(read_qiime_distmat(dist_fp), Feces.df$SampleID) #Distances

.sex.feces<- pairwise.adonis.dm(dist_in.feces, Feces.df$sex_cage) %>% mutate(Category= "Sex")
.treatment.feces<- pairwise.adonis.dm(dist_in.feces, Feces.df$study_group)  %>% mutate(Category= "Treatment")


#Create dataframe with the numbers obtained for Feces F-statistics
library(reshape)
list_df <- list(.treatment.feces, .sex.feces)
feces.Fstats <- merge_all(list_df) 
  feces.Fstats["SampleType"] <- "Feces"
head(feces.Fstats)

```
